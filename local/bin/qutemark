#!/bin/bash

qutemarks="/home/felix/.config/qutebrowser/qutemarks"
commands="$(echo -e "add\ndelete\ntabopen\nopen")"

# Select a command
command="$(dmenu <<<"$commands")"
case "$command" in
    "add")
        echo "$QUTE_URL $QUTE_TITLE" >> "$qutemarks"
        ;;
    "delete")
        to_remove="$(cat -n "$qutemarks" | sed 's/^ *//' | dmenu)"
        if [[ "$to_remove" =~ "[0-9]*	.*" ]]; then
            sed -i "${to_remove%%	*}d" "$qutemarks"
        fi
        ;;
    "tabopen"|"open")
        opener="open"
        if [ "$command" = "tabopen" ]; then
            opener="open -t"
        fi
        to_open="$(dmenu < "$qutemarks")"
        echo "$command ${to_open%% *}" >> "$QUTE_FIFO"
        ;;
    *)
        ;;
esac

